legend.text = ggplot2::element_text(c("Sa", "Sb"))) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = c("A", "B")) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = c("S[1]", "S[2]")) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = c(expression("S[1]"),
expression("S[2]"))) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = ggplot2::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
??parse_format
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep("S[", opchar$des$J),
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
plots$stopping  <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
plots$stopping
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(italic(S), "[", opchar$des$J),
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(expression(italic(S)), "[", opchar$des$J),
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
plots$stopping  <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
plots$stopping
expression(italic(S))
int_tibble$key2
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(expression(italic(S)),
"[", opchar$des$J,
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
plots$stopping  <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
##### Outputting #############################################################
if (output) {
output <- list(plot_opchar = plot_opchar, opchar = opchar)
return(output)
}
}
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(paste0(expression(italic(S)), "["),
opchar$des$J),
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
int_tibble$key2
plots$stopping  <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
plots$stopping
int_tibble            <- tidyr::gather(opchar$opchar, "key", "value",
6:(5 + 2*opchar$des$J))
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(c(paste0(expression(italic("E")), "["),
paste0(expression(italic("F")), "[")),
each = opchar$des$J),
rep(1:opchar$des$J, 2), "]"),
each = nrow(opchar$opchar)))
int_tibble$key2
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(c(paste0(expression(italic(E)), "["),
paste0(expression(italic(F)), "[")),
each = opchar$des$J),
rep(1:opchar$des$J, 2), "]"),
each = nrow(opchar$opchar)))
int_tibble$key2
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0)) +
ggthemes::scale_fill_ptol()
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(values = cbPalette,
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(pallete = cbPalette,
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_discrete(pallete = "cbPalette",
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
?scale_fill_discrete
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(pallete = "cbPalette",
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(palette = "cbPalette",
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(palette = cbPalette,
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
??cbPalette
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(palette = c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7"),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(colors = c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7"),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_hue(colours = c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7"),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(colours = c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7"),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
?scale_fill_manual
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(values = c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7"),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(values = rev(c("#999999", "#E69F00", "#56B4E9",
"#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7")),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
ggthemes::ptol_pal(2*opchar$des$J)
?show_col
scales::show_col(ggthemes::ptol_pal()(2*opchar$des$J))
ggthemes::ptol_pal()(2*opchar$des$J)
ggthemes::ptol_pal()(6)
ggthemes::ptol_pal()(9)
sho_col(ggthemes::ptol_pal()(9))
show_col(ggthemes::ptol_pal()(9))
scales::show_col(ggthemes::ptol_pal()(9))
int_tibble            <- tidyr::gather(opchar$opchar, "key", "value",
(6 + 2*opchar$des$J):
(5 + 3*opchar$des$J))
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(paste0(expression(italic(S)), "["),
opchar$des$J),
1:opchar$des$J, "]"),
each = nrow(opchar$opchar)))
plots$stopping  <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(values = ggthemes::ptol_pal()(2*opchar$des$J),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0)) +
ggthemes::scale_fill_ptol()
ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value,
fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(values = ggthemes::ptol_pal()(2*opchar$des$J),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
int_tibble            <- tidyr::gather(opchar$opchar, "key", "value",
6:(5 + 2*opchar$des$J))
int_tibble            <-
dplyr::mutate(int_tibble,
key2 = rep(paste0(rep(c(paste0(expression(italic(E)), "["),
paste0(expression(italic(F)), "[")),
each = opchar$des$J),
rep(1:opchar$des$J, 2), "]"),
each = nrow(opchar$opchar)))
plots$rejection <- ggplot2::ggplot(int_tibble,
ggplot2::aes(tau, value, fill = key2)) +
ggplot2::geom_area() +
ggplot2::xlab(expression(tau)) +
ggplot2::ylab("Stopping probability") +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom",
legend.title    = ggplot2::element_blank()) +
ggplot2::scale_fill_manual(values = ggthemes::ptol_pal()(2*opchar$des$J),
labels = scales::parse_format()) +
ggplot2::scale_x_continuous(expand = c(0, 0),
limits = c(min(opchar$tau),
max(opchar$tau))) +
ggplot2::scale_y_continuous(expand = c(0, 0))
plots$rejection
devtools::document()
library(OptGS)
des <- des_gs()
opchar <- opchar(des)
opchar$opchar
library(OptGS)
opchar <- opchar(des)
opchar$opchar
plot(opchar)
library(OptGS)
plot(opchar)
?set.seed
